import{r as b,S as W,x as X,j as e,y as p,L as z}from"./index-4e201d1a.js";import{C as P,o as V,d as $,m as Z,z as y,U as ee,D as se,s as S,e as ae,f as te,M as ne,I as le,g as re}from"./Layout-7b360987.js";import{T as ie,S as de,C as oe}from"./BulkActionDrawer-7e43914e.js";import{u as me,n as B,b as K,L as U,E as Y}from"./AdminServices-04341510.js";import{I as ce}from"./InputArea-1751f9c9.js";import{E as pe}from"./EditDeleteButton-4abd9477.js";const xe=(m,d)=>{const{isDrawerOpen:o,closeDrawer:l,setIsUpdate:v,lang:x}=b.useContext(W),[C,D]=b.useState({}),[g,w]=b.useState(""),[f,T]=b.useState(""),[s,h]=b.useState([]),[n,c]=b.useState(x),[_,A]=b.useState(!0),[E,L]=b.useState(""),[H,N]=b.useState(!1);console.log(f,"imgae");const{register:O,handleSubmit:a,setValue:t,clearErrors:r,reset:I,formState:{errors:F}}=me(),G=async({name:u,description:i})=>{var R,k;try{N(!0);const j=await V(u,n),Q=await V(i,n);console.log(f,"catorysubmit");const q={name:{[n]:u,...j},description:{[n]:i||"",...Q},parentId:g||void 0,parentName:E||"Home",icon:f,status:_?"show":"hide",lang:n};if(m){const M=await P.updateCategory(m,q);v(!0),N(!1),K(M.message),l(),I()}else{const M=await P.addCategory(q);v(!0),N(!1),K(M.message),l()}}catch(j){N(!1),B(j?(k=(R=j==null?void 0:j.response)==null?void 0:R.data)==null?void 0:k.message:j==null?void 0:j.message),l()}},J=u=>{c(u),Object.keys(C).length>0&&(t("name",C.name[u||"en"]),t("description",C.description[u||"en"]))};return b.useEffect(()=>{var u;if(!o){D({}),t("name"),t("parentId"),t("parentName"),t("description"),t("icon"),T(""),A(!0),r("name"),r("parentId"),r("parentName"),r("description"),L("Home"),c(x),t("language",n),d!==void 0&&((u=d[0])==null?void 0:u._id)!==void 0&&w(d[0]._id);return}m&&(async()=>{try{const i=await P.getCategoryById(m);i&&(D(i),t("name",i.name[n||"en"]),t("description",i.description[n||"en"]),t("language",n),t("parentId",i.parentId),t("parentName",i.parentName),L(i.parentName),w(i.parentId),T(i.icon),A(i.status==="show"))}catch(i){B(i?i.response.data.message:i.message)}})()},[m,t,o,n,r,d,x]),{register:O,handleSubmit:a,onSubmit:G,errors:F,imageUrl:f,setImageUrl:T,children:s,setChildren:h,published:_,setPublished:A,checked:g,setChecked:w,isSubmitting:H,selectCategoryName:E,setSelectCategoryName:L,handleSelectLanguage:J}},ue=({id:m,data:d,lang:o})=>{const{t:l}=X(),{checked:v,register:x,onSubmit:C,handleSubmit:D,errors:g,imageUrl:w,setImageUrl:f,published:T,setPublished:s,setChecked:h,selectCategoryName:n,setSelectCategoryName:c,handleSelectLanguage:_,isSubmitting:A}=xe(m,d),E=`
  .rc-tree-child-tree {
    display: hidden;
  }
  .node-motion {
    transition: all .3s;
    overflow-y: hidden;
  }
`,L={motionName:"node-motion",motionAppear:!1,onAppearStart:a=>({height:0}),onAppearActive:a=>({height:a.scrollHeight}),onLeaveStart:a=>({height:a.offsetHeight}),onLeaveActive:()=>({height:0})},H=a=>{let t=[];for(let r of a)t.push({title:S(r.name,o),key:r._id,children:r.children.length>0&&H(r.children)});return t},N=(a,t)=>{var r;return a._id===t?a:(r=a==null?void 0:a.children)==null?void 0:r.reduce((I,F)=>I??N(F,t),void 0)},O=async a=>{if(a!==void 0)if(m){const t=await P.getCategoryById(a);if(m===a)return B("This can't be select as a parent category!");if(m===t.parentId)return B("This can't be select as a parent category!");{if(a===void 0)return;h(a);const r=d[0],I=N(r,a);c(S(I==null?void 0:I.name,o))}}else{if(a===void 0)return;h(a);const t=d[0],r=N(t,a);c(S(r==null?void 0:r.name,o))}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:m?e.jsx($,{register:x,handleSelectLanguage:_,title:l("UpdateCategory"),description:l("UpdateCategoryDescription")}):e.jsx($,{register:x,handleSelectLanguage:_,title:l("AddCategoryTitle"),description:l("AddCategoryDescription")})}),e.jsx(Z,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:D(C),children:[e.jsxs("div",{className:"p-6 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(U,{label:l("Name")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ce,{register:x,label:"Category title",name:"name",type:"text",placeholder:l("ParentCategoryPlaceholder")}),e.jsx(Y,{errorName:g.name})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(U,{label:l("Description")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ie,{required:!0,register:x,label:"Description",name:"description",type:"text",placeholder:"Category Description"}),e.jsx(Y,{errorName:g.description})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(U,{label:l("ParentCategory")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4 relative",children:[e.jsx(p.Input,{readOnly:!0,...x("parent",{required:!1}),name:"parent",value:n||"Home",placeholder:l("ParentCategory"),type:"text",className:"border h-12 w-full text-sm focus:outline-none block bg-gray-100 dark:bg-white border-transparent focus:bg-white"}),e.jsxs("div",{className:"draggable-demo capitalize",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:E}}),e.jsx(y,{expandAction:"click",treeData:H(d),selectedKeys:[v],onSelect:a=>O(a[0]),motion:L,animation:"slide-up"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(U,{label:l("CategoryIcon")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(ee,{imageUrl:w,setImageUrl:f,folder:"category"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(U,{label:l("Published")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(de,{handleProcess:s,processOption:T})})]})]}),e.jsx(se,{id:m,title:"Category",isSubmitting:A})]})})]})},Se=({data:m,lang:d,isCheck:o,categories:l,setIsCheck:v,useParamId:x,showChild:C})=>{const{title:D,serviceId:g,handleModalOpen:w,handleUpdate:f}=ae(),T=s=>{const{id:h,checked:n}=s.target;v([...o,h]),n||v(o.filter(c=>c!==h))};return e.jsxs(e.Fragment,{children:[(o==null?void 0:o.length)<1&&e.jsx(te,{useParamId:x,id:g,title:D}),e.jsx(ne,{children:e.jsx(ue,{id:g,data:m,lang:d})}),e.jsx(p.TableBody,{children:l==null?void 0:l.map(s=>{var h,n;return e.jsxs(p.TableRow,{children:[e.jsx(p.TableCell,{children:e.jsx(oe,{type:"checkbox",name:"category",id:s._id,handleClick:T,isChecked:o==null?void 0:o.includes(s._id)})}),e.jsx(p.TableCell,{className:"font-semibold uppercase text-xs",children:(h=s==null?void 0:s._id)==null?void 0:h.substring(20,24)}),e.jsx(p.TableCell,{children:s!=null&&s.icon?e.jsx(p.Avatar,{className:"hidden mr-3 md:block bg-gray-50 p-1",src:s==null?void 0:s.icon,alt:s==null?void 0:s.parent}):e.jsx(p.Avatar,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product",className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none"})}),e.jsx(p.TableCell,{className:"font-medium text-sm ",children:(s==null?void 0:s.children.length)>0?e.jsxs(z,{to:`/categories/${s==null?void 0:s._id}`,className:"text-blue-700",children:[S(s==null?void 0:s.name,d),e.jsx(e.Fragment,{children:C&&e.jsxs(e.Fragment,{children:[" ",e.jsx("div",{className:"pl-2 ",children:(n=s==null?void 0:s.children)==null?void 0:n.map(c=>e.jsx("div",{children:e.jsx(z,{to:`/categories/${c==null?void 0:c._id}`,className:"text-blue-700",children:e.jsxs("div",{className:"flex text-xs items-center  text-blue-800",children:[e.jsx("span",{className:" text-xs text-gray-500 pr-1",children:e.jsx(le,{})}),e.jsx("span",{className:"text-gray-500",children:S(c.name,d)})]})})},c._id))})]})})]}):e.jsx("span",{children:S(s==null?void 0:s.name,d)})}),e.jsx(p.TableCell,{className:"text-sm",children:S(s==null?void 0:s.description,d)}),e.jsx(p.TableCell,{className:"text-center",children:e.jsx(re,{id:s._id,category:!0,status:s.status})}),e.jsx(p.TableCell,{children:e.jsx(pe,{id:s==null?void 0:s._id,parent:s,isCheck:o,children:s==null?void 0:s.children,handleUpdate:f,handleModalOpen:w,title:S(s==null?void 0:s.name,d)})})]},s._id)})})]})};export{ue as C,Se as a};
