import{t as R,r as l,S as U}from"./index-4e201d1a.js";import{u as _,n as f,b as S}from"./AdminServices-04341510.js";import{e as $,o as T,A as m}from"./Layout-7b360987.js";const K=n=>{const o=R(),{isDrawerOpen:x,closeDrawer:c,setIsUpdate:p,lang:y}=l.useContext(U),[u,d]=l.useState([]),[s,C]=l.useState(y),[w,I]=l.useState({}),[v,E]=l.useState(!1),[V,i]=l.useState(!1),{setServiceId:h}=$();let A=[];(async()=>{for(let t=0;t<u.length;t++){const a=await T(u[t],s);A=[...A,{name:{[s]:u[t],...a}}]}})();const{handleSubmit:L,register:j,setValue:r,clearErrors:b,formState:{errors:B}}=_(),k=async({title:t,name:a,option:e})=>{try{if(i(!0),!n&&u.length===0){f("Minimum one value is required for add attribute!");return}const g=await T(t,s),P=await T(a,s),O={title:{[s]:t,...g},name:{[s]:a,...P},variants:A,option:e,type:"attribute",lang:s};if(n){const D=await m.updateAttributes(n,O);p(!0),i(!1),S(D.message),c(),h()}else{const D=await m.addAttribute(O);p(!0),i(!1),S(D.message),c(),h()}}catch(g){f(g?g.response.data.message:g.message),c(),i(!1),h()}},q=async({name:t})=>{try{if(i(!0),n){const a=await m.updateChildAttributes({ids:o.pathname.split("/")[2],id:n},{name:{[s]:t},status:v?"show":"hide"});p(!0),i(!1),S(a.message),c()}else{const a=await m.addChildAttribute(o.pathname.split("/")[2],{name:{[s]:t},status:v?"show":"hide"});p(!0),i(!1),S(a.message),c()}}catch(a){f(a?a.response.data.message:a.message),c(),i(!1),h()}},F=t=>{C(t),Object.keys(w).length>0&&(r("title",w.title[t||"en"]),r("name",w.name[t||"en"]))},H=t=>{d([...u.filter((a,e)=>e!==t)])},M=t=>{t.preventDefault(),t.target.value!==""&&(console.log(t.target.value,"targ"),d([...u,t.target.value]),t.target.value="")};return l.useEffect(()=>{if(!x){I({}),r("title"),r("name"),r("option"),b("title"),b("name"),b("option"),d([]),C(y),r("language",s);return}o.pathname==="/attributes"&&n?(async()=>{var t,a;try{const e=await m.getAttributeById(n);e&&(I(e),r("title",e.title[s||"en"]),r("name",e.name[s||"en"]),r("option",e.option))}catch(e){f(e?(a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message:e.message)}})():o.pathname===`/attributes/${o.pathname.split("/")[2]}`&&(async()=>{var t,a;try{const e=await m.getChildAttributeById({id:o.pathname.split("/")[2],ids:n});e&&(r("name",e.name[s||"en"]),E(e.status==="show"))}catch(e){f(e?(a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message:e.message)}})()},[b,n,x,r,o,s,y]),{handleSubmit:L,onSubmits:q,onSubmit:k,register:j,errors:B,variants:u,setVariants:d,addVariant:M,removeVariant:H,published:v,setPublished:E,isSubmitting:V,handleSelectLanguage:F}};export{K as u};
